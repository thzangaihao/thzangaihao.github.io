<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<title>03. SV-GWAS - 海钊知识港</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta name="collection" content="gwas"> 
		<meta name="collection-title" content="GWAS">
		<meta name="parent-path" content="../../dry_lab_index.html">
		<meta name="parent-title" content="干实验">
		<meta name="date" content="2026-01-28">
		<meta name="description" content="分析结构变异对性状的影响">

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
		<link rel="stylesheet" href="../../../../css/global.css">
		
		<script>window.footerPath = '../../../../footer.html';</script>
		<script src="../../../../js/global.js"></script>
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	</head>

	<body class="article-page">
		<nav>
			<div class="logo"><a href="../../../../index.html">海钊知识港</a></div>
			<div class="nav-links">
				<a href="../../../wet_lab/wet_lab_index.html"><i class="fas fa-flask"></i> 湿实验</a>
				<a href="../../dry_lab_index.html" class="active"><i class="fas fa-code"></i> 干实验</a>
				<a href="../../../resources/resources_index.html"><i class="fas fa-book"></i> 资源站</a>
				<a href="../../../about/about_index.html"><i class="fas fa-user"></i> 关于我</a>
			</div>
		</nav>

		<div class="article-container">
			<h1>03. SV-GWAS</h1>
			
			<div class="content">
				<h2>前言</h2>
				<p>这篇文章详细的介绍了如何从<code>.delly.vcf</code>到最终每个变异位点的关联性。</p>
				<h2>1. vcf 提取与整理</h2>
				<p>将散落在各个子文件夹中的<code>.vcf.gz</code>文件进行提取并汇总到<code>01_Raw_VCFs</code>文件夹中。</p>
				<blockquote>注意，因为压缩包形式具有存储和读取的优势，我们提取并存储的是<code>.vcf.gz</code>和其索引。</blockquote>
				<p>使用交互式脚本进行作业：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>01_vcf整理</h5>
							<span>文件格式：.py | 大小：5.8 KB</span>
						</div>
					</div>
					<a href="./01_vcf整理.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<pre><code class="language-bash">
(base) [thz@localhost SV_GWAS]$ python 01_vcf整理.py
--- 基因型文件(.vcf.gz) 批量搜集工具 ---
该脚本将扫描子目录，将选中的 VCF.GZ 文件复制到统一文件夹 (不解压)。

1. 正在搜索后缀为 .vcf.gz 的文件...

2. 找到 336 个 .vcf.gz 文件:
	... (共 336 个文件，列表过长仅显示部分示例) ...
	[1] E100.delly.vcf.gz
	[2] E101.delly.vcf.gz
	...
	[335] E98.delly.vcf.gz
	[336] E99.delly.vcf.gz

3. 请输入欲处理的 .vcf.gz 文件 编号
	(支持格式: 1,2 | 1-4 | 1,3,5-8 | all): 
all

4. 已选择 336 个文件准备复制。
是否确认开始执行复制操作? (y/n): y

已创建输出目录: /home/thz/SV_GWAS/01_Raw_VCFs
--------------------------------------------------
[1/336] 正在复制: E100.delly.vcf.gz ... 完成
[2/336] 正在复制: E101.delly.vcf.gz ... 完成
......
[335/336] 正在复制: E98.delly.vcf.gz ... 完成
[336/336] 正在复制: E99.delly.vcf.gz ... 完成
--------------------------------------------------
处理结束。成功复制 336 / 336 个文件。
文件保存在: /home/thz/SV_GWAS/01_Raw_VCFs
				</code></pre>
				<h2>2. Delly 合并</h2>
				<p>我们要对<code>01_Raw_VCFs</code>里面所有的<code>.vcf.gz</code>进行合并，生成合并后文件<code>Merged_Population_filtered.vcf.gz</code>并创建索引。
				<p>使用交互式脚本进行作业：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>02_vcf合并</h5>
							<span>文件格式：.py | 大小：6.8 KB</span>
						</div>
					</div>
					<a href="./02_vcf合并.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<p>对脚本相关参数进行调节并执行：</p>
				<pre><code class="language-python">
# ==============================================================================
# 0. 全局配置
# ==============================================================================
# 输出目录名称
OUTPUT_DIR_NAME = "02_Merged_Results"
# 输出文件名
OUTPUT_FILENAME = "Merged_Population.vcf.gz"
# 线程数
THREADS = 16

# BCFtools 可执行命令 (如果需要指定路径请修改这里)
BCFTOOLS_EXEC = "bcftools"
				</code></pre>
				<blockquote>如果在后续合并时没有加 -0 参数，软件可能会把补齐的地方填成 $./.$。这代表“不确定这里有没有变异”。但在 SV 分析中，我们通常假设“没检测到就是没有”，所以强制补成 $0/0$。</blockquote>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 02_vcf合并.py
=== VCF.GZ 批量合并工具 (优化版) ===
正在搜索 .vcf.gz 文件...

--- 找到 336 个 .vcf.gz 文件 ---
	[1] E100.delly.vcf.gz
	[2] E101.delly.vcf.gz
	... (中间省略 332 个) ...
	[335] E98.delly.vcf.gz
	[336] E99.delly.vcf.gz

请输入要合并的文件编号 (支持: all | 1-5 | 1,3,5): all

--- 步骤 1/2: 检查文件索引 ---
所有文件均已有索引，跳过构建步骤。

--- 步骤 2/2: 执行合并 ---
创建输出目录: /home/thz/SV_GWAS/02_Merged_Results
执行命令: bcftools merge -l /home/thz/SV_GWAS/02_Merged_Results/merge_list.txt -o /home/thz/SV_GWAS/02_Merged_Results/Merged_Population.vcf.gz -O z --threads 16 -m none -0
--------------------------------------------------
[成功] 合并完成！
结果文件: /home/thz/SV_GWAS/02_Merged_Results/Merged_Population.vcf.gz
正在为结果文件建立索引...
				</code></pre>
				<p>合并后可以使用命令查看表头及数据前几行：</p>
				<pre><code class="language-bash">
# 查看表头前 50 行
bcftools view -h Merged_Population.vcf.gz | head -n 50

# 只查看变异位点（不含表头）前 10 行
bcftools view -H Merged_Population.vcf.gz | head -n 10
				</code></pre>
				<blockquote>打印变异位点后，你会发现大部分变异位点只在一个或者几个样本中出现，我们称为低频率变异，在后续我们会通过质控对这种变异位点进行剔除。</blockquote>
				<h2>3. 位点质控与过滤</h2>
				<p>剔除低频率变异 (默认阈值$MAF < 0.05$)，这些变异不具有普遍性，即使对性状有直接关系得出来的的结论也无法有信服力。我们的核心目的是：找到具有普遍存在的变异类型，并计算这个变异与表型的关联性/独立性。</p>
				<ol>
					我们默认过滤条件如下：
					<li>剔除标记为 LowQual 的低质量变异。</li>
					<li>剔除频率小于 0.05 低频率变异的</li>
				</ol>
				<p>使用交互式脚本进行作业：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>03_质控</h5>
							<span>文件格式：.py | 大小：6.2 KB</span>
						</div>
					</div>
					<a href="./03_质控.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<p>对脚本相关参数进行调节并执行：</p>
				<pre><code class="language-python">
# ==============================================================================
# 0. 核心配置参数
# ==============================================================================
# 输出目录名称
OUTPUT_DIR_NAME = "03_QC_Filtered"

# 过滤条件 (使用 bcftools 表达式)
# 修改点: 增加了 FILTER="PASS" 条件
# 含义: 保留 (FILTER列为PASS) 并且 (次等位基因频率 > 0.05) 的位点
FILTER_EXPRESSION = 'FILTER="PASS" && MAF > 0.05'

# 线程数
THREADS = 16

# 输出格式: 'z' (vcf.gz), 'b' (bcf), 'v' (vcf)
OUTPUT_FORMAT = "z" 

# 可执行程序路径
BCFTOOLS_EXEC = "bcftools"
				</code></pre>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 03_质控.py
==============================================
	Step 3: VCF/BCF 质控与过滤工具
==============================================

2. 找到 337 个 待过滤文件 (VCF/BCF):
	[1] E100.delly.vcf.gz (01_Raw_VCFs/E100.delly.vcf.gz)
	[2] E101.delly.vcf.gz (01_Raw_VCFs/E101.delly.vcf.gz)
	... (中间省略 333 个) ...
	[336] E99.delly.vcf.gz (01_Raw_VCFs/E99.delly.vcf.gz)
	[337] Merged_Population.vcf.gz (02_Merged_Results/Merged_Population.vcf.gz)

3. 请输入编号 (格式: 1,2 | 1-4 | all): 337

4. 已选择 1 个文件。

5. 确认执行过滤操作? (y/n): y

[系统] 创建输出目录: /home/thz/SV_GWAS/03_QC_Filtered

--- [1/1] 正在处理: Merged_Population.vcf.gz ---
过滤条件: MAF > 0.05
执行命令: bcftools view -i MAF > 0.05 /home/thz/SV_GWAS/02_Merged_Results/Merged_Population.vcf.gz -O z -o /home/thz/SV_GWAS/03_QC_Filtered/Merged_Population_filtered.vcf.gz --threads 16
[成功] 输出至: /home/thz/SV_GWAS/03_QC_Filtered/Merged_Population_filtered.vcf.gz
正在建立索引...
				</code></pre>
				<p>现在可以使用命令检查表头及数据前几行：</p>
				<pre><code class="language-bash">
# 查看表头前 50 行
bcftools view -h Merged_Population_filtered.vcf.gz | head -n 50

# 只查看变异位点（不含表头）前 10 行
bcftools view -H Merged_Population_filtered.vcf.gz | head -n 10
				</code></pre>
				<blockquote>质控后你会发现记录的变异位点会在大部分（取决于你设定的阈值）样品中出现。</blockquote>
				<h2>4. PLINK 格式转换</h2>
				<p>大多数 GWAS 软件（包括 GEMMA 和 TASSEL）在处理大规模矩阵时，更喜欢二进制的 PLINK 格式（<code>.bed</code>, <code>.bim</code>, <code>.fam</code>）。</p>
				<p>使用交互式脚本进行作业：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>04_PLINK_格式转换</h5>
							<span>文件格式：.py | 大小：6.0 KB</span>
						</div>
					</div>
					<a href="./04_PLINK_格式转换.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<p>对脚本相关参数进行调节并执行：</p>
				<pre><code class="language-python">
# ==============================================================================
# 0. 核心配置参数
# ==============================================================================
# 输出目录名称
OUTPUT_DIR_NAME = "04_PLINK_Binary"

# PLINK 额外参数
# --allow-extra-chr: 必须开启，因为大多数生物染色体命名通常不是 1-22
# --const-fid: 如果 VCF 没有 Family ID，自动将 Family ID 设为 0
EXTRA_FLAGS = ["--allow-extra-chr", "--const-fid"]

# 可执行程序路径
PLINK_EXEC = "plink"  # 如果需要 PLINK2，请改为 "plink2" 并相应调整参数
				</code></pre>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 04_PLINK_格式转换.py
==============================================
	Step 4: 格式转换工具 (VCF -> PLINK Binary)
==============================================

2. 找到 338 个 待转换文件 (VCF/BCF):
	[1] E100.delly.vcf.gz (01_Raw_VCFs/E100.delly.vcf.gz)
	[2] E101.delly.vcf.gz (01_Raw_VCFs/E101.delly.vcf.gz)
	... (中间省略 324 个) ...
	[337] Merged_Population.vcf.gz (02_Merged_Results/Merged_Population.vcf.gz)
	[338] Merged_Population_filtered.vcf.gz (03_QC_Filtered/Merged_Population_filtered.vcf.gz)

3. 请输入编号 (格式: 1,2 | 1-4 | all): 338

4. 已选择 1 个文件。

5. 确认执行转换操作? (y/n): y

--- [1/1] 正在转换: Merged_Population_filtered.vcf.gz ---
执行命令: plink --vcf /home/thz/SV_GWAS/03_QC_Filtered/Merged_Population_filtered.vcf.gz --make-bed --out /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink --allow-extra-chr --const-fid
......
[成功] 生成: /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink.bed / .bim / .fam
				</code></pre>
				<h2>5. 表型数据清洗</h2>
				<p>将我们的表型文件先转化为<code>.tsv</code>包含表头和样本 ID 的标准文件，进行 ID 对齐和缺失样本剔除。</p>
				<pre><code class="language-tsv">
No  	 PHE_1	 PHE_2	 PHE_3
E11	 28.45	  9.52	  2.91
E12	 21.39	  8.94	  2.55
E13	 24.73	  9.62	  2.78
E14	 23.62	  9.51	  2.52
E15	 31.07	  9.8 	  2.89
E17	 27.35	  9.8 	  2.7
				</code></pre>
				<p>使用交互式脚本进行作业：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>05_表型数据清洗</h5>
							<span>文件格式：.py | 大小：8.3 KB</span>
						</div>
					</div>
					<a href="./05_表型数据清洗.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 05_表型数据清洗.py
==============================================
	Step 5: 表型文件对齐与清洗 (TSV 工具)
==============================================

>>> 第一步: 选择基准基因型文件 (VCF/BCF)

2. 找到 338 个 基因型文件:
	[1] E100.delly.vcf.gz  (路径: 01_Raw_VCFs/E100.delly.vcf.gz)
	[2] E101.delly.vcf.gz  (路径: 01_Raw_VCFs/E101.delly.vcf.gz)
	...
	3. 请输入欲操作的 基因型文件 编号
	(通常请输入单个编号，如 1): 
   338
   
   4. 已选择: Merged_Population_filtered.vcf.gz
   正在从基因型文件中读取样本列表: Merged_Population_filtered.vcf.gz ...
   -> 基因型文件中共有 336 个样本。
   
>>> 第二步: 选择待清洗的表型文件 (TSV)

2. 找到 1 个 TSV 表型文件:
	[1] 性状数据表.tsv  (路径: 性状数据表.tsv)

3. 请输入欲操作的 TSV 表型文件 编号
(通常请输入单个编号，如 1): 
1

4. 已选择: 性状数据表.tsv

正在读取表型文件: 性状数据表.tsv ...

检测到表型文件包含以下列:
	[1] No   
	[2]  性状_1
	[3]  性状_2
	......

请选择代表 '样本ID' 的列编号 (默认 1: No   ): 1
-> 使用 'No   ' 作为样本 ID 进行对齐。

==================================================
【对齐报告】
表型文件原始样本数 : 338
基因型文件样本数   : 336
--------------------------------------------------
对齐成功 (保留)    : 250
对齐失败 (剔除)    : 88
==================================================

[以下样本因无 VCF 数据被剔除]:
	1. E11 
	2. E12 
	3. E13 
	4. E14 
	5. E15  
	... 以及其他 83 个

5. 确认保存清洗后的 TSV 文件? (y/n): y

[成功] 文件已保存至: /home/thz/SV_GWAS/性状数据表_cleaned.tsv
				</code></pre>
				<blockquote>如果发生大量样本丢失，请运行检测脚本诊断表型数据和基因型数据的 ID 对应：</blockquote>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>05_1_测试</h5>
							<span>文件格式：.py | 大小：8.7 KB</span>
						</div>
					</div>
					<a href="./05_1_测试.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>6. 标准表型数据表自动化生成</h2>
				<p>将TSV拆分成多个符合GEMMA 输入的性状数据表文件，以列头性状作为文件命名。</p>
				<p>对脚本相关参数进行调节并执行：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>06_标准表型数据表自动化生成</h5>
							<span>文件格式：.py | 大小：5.9 KB</span>
						</div>
					</div>
					<a href="./06_标准表型数据表自动化生成.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 06_标准表型数据表自动化生成.py
	fam_df = pd.read_csv(fam_path, sep='\s+', header=None, usecols=[1], names=['IID'], dtype=str)
==============================================
	Step 6: 表型拆分与格式化 (GEMMA Ready)
==============================================

>>> 选择 1: 包含多个性状的 TSV 文件

找到 2 个 表型总表:
	[1] 性状数据表.tsv  (路径: 性状数据表.tsv)
	[2] 性状数据表_cleaned.tsv  (路径: 性状数据表_cleaned.tsv)

请输入 表型总表 编号 (单选): 2

>>> 选择 2: PLINK .fam 文件 (用于对齐顺序)

找到 1 个 FAM 文件:
	[1] Merged_Population_filtered_plink.fam  (路径: 04_PLINK_Binary/Merged_Population_filtered_plink.fam)

请输入 FAM 文件 编号 (单选): 1

--- 正在读取数据 ---
FAM 文件样本数: 336
TSV 文件样本数: 250
包含列: ['No   ', ' PHE_1', ' PHE_2', ' PHE_3', ' PHE_4', ' PHE_5']

请确认 TSV 文件中的【样本 ID】列:
	[1] No   
	[2]  PHE_1
	[3]  PHE_2
	[4]  PHE_3
	[5]  PHE_4
	[6]  PHE_5
请输入列编号 (默认 1: No   ): 1

检测到 5 个性状: [' PHE_1', ' PHE_2', ' PHE_3', ' PHE_4', ' PHE_5']

确认开始拆分? (y/n): y

--- 开始输出 (保存至 06_GEMMA_Phenotypes) ---
	-> 生成: PHE_1.txt
	-> 生成: PHE_2.txt
	-> 生成: PHE_3.txt
	-> 生成: PHE_4.txt
	-> 生成: PHE_5.txt

[成功] 已拆分 5 个性状文件。
提示：这些文件可以直接用于 GEMMA 的 -p 参数。
				</code></pre>
				<h2>7. 关联性分析</h2>
				<p>万事俱备，只欠东风：运行最后的关联性分析：</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>07_关联性分析</h5>
							<span>文件格式：.py | 大小：8.3 KB</span>
						</div>
					</div>
					<a href="./07_关联性分析.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<blockquote>工作目录会多出一个 'output' 文件夹，GEMMA 会强制输出到当前目录下的 'output' 文件夹，我们需要确保这个文件夹存在，否则 GEMMA 会报错，最后把这个 'output' 空文件夹删除就行了。</blockquote>
				<pre><code class="language-bash">
(gwas_fix) [thz@localhost SV_GWAS]$ python 07_关联性分析.py 
==============================================
	Step 7: 批量 GWAS 分析运行器 (GEMMA)
==============================================

>>> 第一步: 选择基因型数据 (.fam/.bed)

2. 找到 1 个基因型文件:
	[1] Merged_Population_filtered_plink.fam

3. 请输入基因型文件编号 (单选): 1

>>> 第二步: 选择要分析的性状文件 (.txt)

2. 找到 5 个 性状文件:
	[1] PHE_1.txt
	[2] PHE_2.txt
	[3] PHE_3.txt
	[4] PHE_4.txt
	[5] PHE_5.txt

3. 请输入欲分析的 性状文件 编号
	(输入 'all' 全选，或格式: 1,2 | 1-4): 
all

4. 已选择 5 个文件待分析。

5. 确认开始批量运行? (y/n): y

--- 开始批量 GWAS 分析 (共 5 个任务) ---

>>> [1/5] 正在分析性状: PHE_1
执行命令: gemma -bfile /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink -p /home/thz/SV_GWAS/06_GEMMA_Phenotypes/PHE_1.txt -o PHE_1 -lm 1
GEMMA 0.98.3 (2020-11-28) by Xiang Zhou and team (C) 2012-2020
Reading Files ... 
## number of total individuals = 336
## number of analyzed individuals = 336
## number of covariates = 1
## number of phenotypes = 1
## number of total SNPs/var        =    17156
## number of analyzed SNPs         =    17150
================================================== 100%
**** INFO: Done.
	[成功] 结果已保存: PHE_1.assoc.txt

>>> [2/5] 正在分析性状: PHE_2
执行命令: gemma -bfile /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink -p /home/thz/SV_GWAS/06_GEMMA_Phenotypes/PHE_2.txt -o PHE_2 -lm 1
GEMMA 0.98.3 (2020-11-28) by Xiang Zhou and team (C) 2012-2020
Reading Files ... 
## number of total individuals = 336
## number of analyzed individuals = 336
## number of covariates = 1
## number of phenotypes = 1
## number of total SNPs/var        =    17156
## number of analyzed SNPs         =    17150
================================================== 100%
**** INFO: Done.
	[成功] 结果已保存: PHE_2.assoc.txt

>>> [3/5] 正在分析性状: PHE_3
执行命令: gemma -bfile /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink -p /home/thz/SV_GWAS/06_GEMMA_Phenotypes/PHE_3.txt -o PHE_3 -lm 1
GEMMA 0.98.3 (2020-11-28) by Xiang Zhou and team (C) 2012-2020
Reading Files ... 
## number of total individuals = 336
## number of analyzed individuals = 336
## number of covariates = 1
## number of phenotypes = 1
## number of total SNPs/var        =    17156
## number of analyzed SNPs         =    17150
================================================== 100%
**** INFO: Done.
	[成功] 结果已保存: PHE_3.assoc.txt

>>> [4/5] 正在分析性状: PHE_4
执行命令: gemma -bfile /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink -p /home/thz/SV_GWAS/06_GEMMA_Phenotypes/PHE_4.txt -o PHE_4 -lm 1
GEMMA 0.98.3 (2020-11-28) by Xiang Zhou and team (C) 2012-2020
Reading Files ... 
## number of total individuals = 336
## number of analyzed individuals = 336
## number of covariates = 1
## number of phenotypes = 1
## number of total SNPs/var        =    17156
## number of analyzed SNPs         =    17150
================================================== 100%
**** INFO: Done.
	[成功] 结果已保存: PHE_4.assoc.txt

>>> [5/5] 正在分析性状: PHE_5
执行命令: gemma -bfile /home/thz/SV_GWAS/04_PLINK_Binary/Merged_Population_filtered_plink -p /home/thz/SV_GWAS/06_GEMMA_Phenotypes/PHE_5.txt -o PHE_5 -lm 1
GEMMA 0.98.3 (2020-11-28) by Xiang Zhou and team (C) 2012-2020
Reading Files ... 
## number of total individuals = 336
## number of analyzed individuals = 336
## number of covariates = 1
## number of phenotypes = 1
## number of total SNPs/var        =    17156
## number of analyzed SNPs         =    17150
================================================== 100%
**** INFO: Done.
	[成功] 结果已保存: PHE_5.assoc.txt

==================================================
批量分析完成！
所有结果文件已存放于: /home/thz/SV_GWAS/07_GWAS_Results
==================================================
				</code></pre>
				<h2>8. 阈值位点筛选</h2>
				<p>通过脚本根据阈值筛选出具有显著性的位点，获得位点具体信息。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>08_结果筛选</h5>
							<span>文件格式：.py | 大小：7.5 KB</span>
						</div>
					</div>
					<a href="./08_结果筛选.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>9. 结果可视化</h2>
				<p>使用脚本自动绘制曼哈顿图和 QQ 图。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>09_曼哈顿图</h5>
							<span>文件格式：.py | 大小：9.0 KB</span>
						</div>
					</div>
					<a href="./09_曼哈顿图.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>10. Kinship 矩阵构建</h2>
				<p>如果群体有较大的亲缘关系，导致普通的 LM 分析出现曼哈顿图“爆炸”（某条染色体大量超阈值），QQ 图起飞（膨胀），则应该升级统计模型从 LM 到 LMM 模型。我们先利用基因型文件构建 Kinship 矩阵来量化各样本间亲缘关系。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>10_Kinship 矩阵计算</h5>
							<span>文件格式：.py | 大小：6.8 KB</span>
						</div>
					</div>
					<a href="./10_Kinship 矩阵计算.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>11. LMM 混合线性模型</h2>
				<p>进行混合线性模型进行计算。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>11_LMM 混合线性模型</h5>
							<span>文件格式：.py | 大小：7.2 KB</span>
						</div>
					</div>
					<a href="./11_LMM 混合线性模型.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<blockquote>后续对输出的<code>.assoc.txt</code>再进行第 8 步和第 9 步。绘制 QQ 图和曼哈顿图，筛选阈值点。</blockquote>
				<h2>12. Kinship 可视化</h2>
				<p>亲缘关系矩阵可视化，如果某些样本聚集在一起形成一个明显的深色方阵，说明它们是一个亚群。如果背景中有很多零散的深色点，说明样本之间存在普遍的近亲关系或者复杂的杂交历史。</p>				
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>12_Kinship 可视化</h5>
							<span>文件格式：.py | 大小：6.1 KB</span>
						</div>
					</div>
					<a href="./12_Kinship 可视化.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>13. 位点溯源</h2>
				<p>对第 8 步筛选出来的位点在合并的 <code>vcf</code> 里面查找，给出变异具体信息。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>13_位点溯源</h5>
							<span>文件格式：.py | 大小：9.0 KB</span>
						</div>
					</div>
					<a href="./13_位点溯源.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div> 
				<h2>14. IGV 可视化</h2>
				<p>将第 13 步的详细文件转换为可以供 IGV 可视化的 <code>.gff3</code>文件。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>14_IGV 可视化</h5>
							<span>文件格式：.py | 大小：6.0 KB</span>
						</div>
					</div>
					<a href="./14_IGV 可视化.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<h2>15. 主成分分析</h2>
				<p>看样品被分为哪些亚群。</p>
				<div class="download-card">
					<div class="download-info">
						<i class="fas fa-file-code"></i> <div class="file-details">
							<h5>15_PCA</h5>
							<span>文件格式：.py | 大小：6.1 KB</span>
						</div>
					</div>
					<a href="./15_PCA.py" download class="download-btn">
						<i class="fas fa-cloud-download-alt"></i>
					</a>
				</div>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
				<p></p>
			</div>
		</div>

		<div id="footer-placeholder"></div>
	</body>
</html>